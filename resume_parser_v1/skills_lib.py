# -*-coding:utf-8 -*-
import pandas as pd
import re,string,os

from collections import defaultdict
class SkillExtraction:
    def __init__(self):
        skill_file_path=os.path.join(os.path.dirname(os.path.abspath(__file__)),"skills_vikas.csv")
        _df = pd.read_csv(skill_file_path, encoding='cp1252')
        _skills = set(_df["skills"])
        self.string_punchuations = list(string.punctuation)
        print("Total number of skills: %d" % len(_skills))
        _skills_set_ngram = self.get_matching_set_ngram(_skills)
        self._skills_set_ngram = _skills_set_ngram


    def read_file(self,file_address, format="list"):
        with open(file_address, "rb") as f:
            contents = f.read()
        if format == "list":
            return [t for t in contents.decode("utf-8", "ignore").split("\n") if t != ""]
        elif format == "text":
            return contents.decode("utf-8", "ignore")


    def add_space(self,text):
        if text == "":
            return ""
        new_text = "" + text[0]
        for i in range(1, len(text)):
            if (text[i].isalpha() and text[i - 1].isnumeric()) | (
                text[i].isnumeric() and text[i - 1].isalpha()
            ):
                new_text += " " + text[i]
            else:
                new_text += text[i]
        return new_text


    def clean_text(self, text):
        text = "".join([c if (c.isalnum() or c in "+#.") else " " for c in text])
        text = self.add_space(text)
        text = " ".join([t for t in text.split(" ") if t != ""])
        return text.lower()


    def get_ngram_list(self, text, n):
        ngram_list = []
        n -= 1
        text = " ".join([t for t in text.split(" ") if t != ""])
        for i in range(n + 1):
            if i - n != 0:
                ngram_list.append(text.split(" ")[i : i - n])
            else:
                ngram_list.append(text.split(" ")[i:])
        return ngram_list


    def get_ngrams(self, text, n):
        ngrams = [" ".join(b) for l in text for b in zip(*self.get_ngram_list(l, n))]
        return ngrams


    def get_matching_set_ngram(self,matching_list):
        # matching_ngrams = defaultdict(lambda :set())
        matching_ngrams = defaultdict(set)
        for matching_item in matching_list:
            if not isinstance(matching_item, str):
                continue
            k = len(matching_item.split())
            if k <= 5:
                matching_ngrams[k].add(" ".join(matching_item.split()).strip())
        return matching_ngrams


    def get_super_strings(self,list_of_strings):
        sub_strings = []
        for st in list_of_strings:
            for st1 in list_of_strings:
                if st in st1 and st != st1:
                    sub_strings.append(st)
        return [s for s in list_of_strings if s not in sub_strings]



    def match(self,text):
        matching_set_ngram = self._skills_set_ngram
        text = [self.clean_text(line) for line in text]
        list_of_matches = set()
        for n, matching_set in matching_set_ngram.items():
            tokens = self.get_ngrams(text, n)
            for token in tokens:
                for punch in self.string_punchuations:
                    if str(token).endswith(str(punch)):
                        token=str(token)[:-1].strip()
                if token.lower() in matching_set:
                    list_of_matches.add(token)
        super_strings = self.get_super_strings(list_of_matches)
        return ",".join(super_strings)

if __name__=="__main__":
    obj = SkillExtraction()
    text =['summary', 'over 8 years sdlc experience in design development deployment and testing of enterprise applications.', 'worked on new features of java 8 annotations generics enhanced for loop enums and lambda expressions.', 'experience in developing user interface using angular framework html cssand javascript.', 'experienced working in projects involving agile scrum test first incremental and iterative development.', 'ambitious go getter with extensive adaptiveness in web application development using spring hibernate soap restful ajax xml drools html 5 javascript angular and bootstrap.', 'performance targeted implementer with substantial experience in service oriented architecture soa using web services such as soap using apache cfx restful using jersey and jackson.', 'worked on soa such as apache axis web services soap wsdl. exposure to jaxb jax ws and jax rs.', 'quick witted competent with skillful ability in using spring dependency injection spring mvc spring security spring jdbc spring mobile spring rest spring boot and object relational mapping frameworks orm s like hibernate with mapping of persistent classes and usage of hibernate query language.', 'developed reusable and interoperable web service modules based on soa architecture using soap restful.', 'extensively used different tag libraries like jsf tags struts tags jstl spring tags spring el display tag.', 'experienced in client side validation client server data interactionusing ajax in nodejs.', 'developed core modules in large cross platform applications using java j 2 ee hibernate jsp servlets jdbc javascript ajax jquery xml and html.', 'technically savvy in using multiple rdbms like asp.net ibm db 2 oracle sql server and mysql.', 'mission focused aspirant with sweeping proficiency in using version controls suchas svn and git.', 'experience in database modeling design and development of pl sql stored procedures packages in relational databases oracle 10 g 11 g ibm db 2 mysql sybase sql server 2000 and mongodb.', 'worked on aws high availability practices and deploying backup restore infrastructure', 'developed a serverless application using aws lambda in integration with api gateway s 3 iam ec 2 and code deploy.', 'expertise in software configuration management using cvs svn and ibm clear case. hands on experience with build tools like ant maven and logging tools like log 4 j.', 'spearheaded application developer conversant with developing applications using various servers including apache tomcat ibm websphere bea weblogic and jboss application server.', 'experienced in developing unix shell scripts for batch processing.', 'skills', 'languages api', 'java java j 2 ee jdbc uml design patterns shell scripts html javascript sql and pl sql', 'cloud environments', 'aws micro services.', 'frameworks', 'struts 1.x 2.0 spring 3.x 4.0 hibernate 3.x', 'web technologies', 'html css dhtml servlets jsps ejb jquery ajax angularjs angular 2 4 6 8 json.', 'web application servers', 'apache tomcat 5.x 4.x ibm websphere bea weblogic and j boss', 'ide s', 'eclipse', 'databases', 'oracle sql server mysql sybase db 2 and nosql mongo cassandra', 'version control', 'git bitbucket', 'other utilities', 'ant log 4 j and maven', 'work experience', 'client anthem inc atlanta ga nov 19 till date', 'role sr java full stack developer', 'work highlights', 'worked on complete agile development story grooming estimations retrospectives and spring planning.', 'utilized modernizer extensively to build html 5 css 3 based page layouts that are cross browser compatible.', 'implemented client side interface using reactjs. worked on responsive design and developed a single web page applications responsive website that could be served to desktop tablets and mobile users using reactjs.', 'utilized create react app to launch product to stay update with current webpack configuration.', 'developed web api using node js and hosted on multiple load balanced api instances.', 'developed spring boot to fasten the application for removing boiler plate configurations by using lamda expressions java 8', 'used loosely coupled architecture spring boot. developed micro services in the application by using spring boot.', 'developed micro services for service oriented architecture to build flexible and independently deployable software.', 'developed rest web servicesusing lambda functionality clients to consume those web services as well other enterprise wide web services.', 'development of cloud hosted web applications and rest apis using spring boot with embedded tomcat.', 'involved in implementing queries to the backend mongodb database using http service to fetch json contract.', 'unstructured data was handled using mongo db and used mongoose connector for connecting to database.', 'composed and executed mongodb scripts and queries to fetch and test data from nosql databases.', 'responsible for installation configuration of jenkins to support various java builds and jenkins plugins to automate continuous builds and publishing docker images to the nexus repository.', 'used ci cd tools jenkins git and docker registry for configuration.', 'used drools as rule engine to categorize salient level rule to every business rules base on the business needs.', 'environment java 8 lambda html 5 css 3 javascript reactjs jquery oracle bitbucket mongodb springs.', 'client t mobile bellevue wa july 18 oct 19', 'role sr java full stack developer', 'work highlights', 'worked on complete agile development story grooming estimations retrospectives and spring planning.', 'developed kbs flows using ard from user stories.', 'developed user interface with html 5 css 3 json ajax angular and type script.', 'worked onstreams lambda s and functional interfaces using python.', 'worked with single page application framework angular extensively using routing services views directives navigation through the different status and multiple modules.', 'used angular http module to make api calls and worked with the observables.', 'used other front end technologies such as java 8 javascript jquery html 5 css and bootstrap.', 'designed and developed rest web services based on rest architecture implemented various http methods did error handling to provided data to the front end angular in json format.', 'developed restful service interface using spring boot to the underlying agent services api.', 'established simulation service with spring boot and restusinglambda expressions java 8 .', 'implemented the project structure based on spring mvc pattern using spring boot.', 'developed multi threaded producer and consumer mq applications using spring boot.', 'developed restful service interface using spring boot to the underlying agent services api.', 'used spring inheritance to develop beans from already developed parent beans.', 'integrated spring orm frameworks hibernate for database operations with oracle.', 'used hibernate transaction management hibernate batch transactions and cache concepts.', 'used apache kafka for building real time streaming data pipelines message queues for asynchronous exchange of vital information between multiple business applications.', 'written sql scripts and pl sql scripts to extract data from database and for testing purposes.', 'supporting daily loads and work with business users to handle rejected data.', 'developed interfaces using unix shell scripts to automate the bulk load update processes.', 'executing test scripts to verify actual results against expected results by using power connect for source db 2 validation and oracle for target validations.', 'supported change management tasks to deploy code in qa cert testing and then into production.', 'utilized aws lambda platform to upload data into aws s 3 buckets and to trigger other lambda functions.', 'installed the application on aws ec 2 instances and configured the storage on s 3 buckets.', 'worked on kubernetescreating and managing containerization of application.', 'worked on creation of custom docker container images tagging and pushing the images.', 'performed unit testing for java using junit and jasmine framework for javascript testing.', 'environment html 5 css 3 ajax json java 8 type script bootstrap java spring boot spring mvc hibernate angular 2.0 rest web services aws soap ui docker apache kafka junit jasmine.', 'client fedex collierville tn dec 2016 to june 18', 'role sr java full stack developer', 'work highlights', 'worked on complete agile development story grooming estimations retrospectives and spring planning.', 'developed user interface with html 5 css 3 saas json ajax angular 2 and type script.', 'worked with streams lambda s and functional interfaces using java 1.8 .', 'worked with single page application framework angular 4 extensively using routing services views directives navigation through the different status and multiple modules.', 'used angular 4 http module to make api calls and worked with the observables.', 'used other front end technologies such as javascript jquery html 5 css 3.0 and bootstrap.', 'designed and developed rest web services based on rest architecture implemented various http methods did error handling to provided data to the front end angular 4 in json format.', 'designed modular and reusable react components using redux architecture and material ui.', 'worked in using react components forms events keys router animations and redux concepts.', 'developed restful service interface using spring boot to the underlying agent services api.', 'established simulation service with spring bootand rest.', 'implemented the project structure based on spring mvc pattern using spring boot.', 'developed multi threaded producer and consumer mq applications using spring boot.', 'developed restful service interface using spring boot to the underlying agent services api.', 'used spring inheritance to develop beans from already developed parent beans.', 'integrated spring orm frameworks hibernate for database operations with oracle.', 'used hibernate transaction management hibernate batch transactions and cache concepts.', 'used apache kafka for building real time streaming data pipelines message queues for asynchronous exchange of vital information between multiple business applications.', 'written sql scripts and pl sql scripts to extract data from database and for testing purposes.', 'supporting daily loads and work with business users to handle rejected data.', 'developed interfaces using unix shell scripts to automate the bulk load update processes.', 'executing test scripts to verify actual results against expected results by using power connect for source db 2 validation and oracle for target validations.', 'performed service level testing for web services using soap ui.', 'supported change management tasks to deploy code in qa cert testing and then into production.', 'utilized aws lambda platform to upload data into aws s 3 buckets and to trigger other lambda functions.', 'installed the application on aws ec 2 instances and configured the storage on s 3 buckets', 'worked on creation of custom docker container images tagging and pushing the images.', 'performed unit testing for java using junit and jasmine framework for javascript testing.', 'environment html 5 css 3 ajax json saas type script bootstrap java 1.8 spring boot spring mvc hibernate angular 2.0 rest web services reactjs aws ec 2 s 3 soap ui docker axon apache kafka junit jasmine.', 'client penske reading pa aug 2015 to oct 2016', 'role sr java developer', 'work highlights', 'designed coded implemented optimization and tested new features and modules for the derivatives system as part of an agile team and improved automation test suites.', 'utilized modernizer extensively to build html 5 css 3 based page layouts that are cross browser compatible.', 'implemented client side interface using reactjs. worked on responsive design and developed a single web page applications responsive website that could be served to desktop tablets and mobile users using react js.', 'utilized create react app to launch product to stay update with current webpack configuration.', 'gained knowledge on electrode platform nodejs web platform built on top of the reactjs frameworks.', 'developed web api using node js and hosted on multiple load balanced api instances.', 'developed spring boot to fasten the application for removing boiler plate configurations.', 'used loosely coupled architecture spring boot. developed micro services in the application by using spring boot.', 'developed micro services for service oriented architecture to build flexible and independently deployable software.', 'developed restweb services clients to consume those web services as well other enterprise wide web services.', 'worked with spring aop module to perform logging operations.', 'developed independent microservices using spring boot rest controller model and are deployed on unix boxes.', 'employed spring boot for initialize and bootstrapping the build configuration for the boot based web applications.', 'development of cloud hosted web applications and rest apis using spring boot with embedded tomcat.', 'extensively used jenkins as continuous integration tools to deploy the spring boot microservices to pivotal cloud foundry pcf using build pack. used pivotal cloud foundry to quickly build deploy and update the applications.', 'utilized hibernate for object relational mapping orm purposes for persistence on to the database.', 'developed different join strategies with hibernate to improve performance while retrieving collection items.', 'used spring mvcand hibernate to establish the connection with database for stored procedures.', 'involved in implementing queries to the backend mongodb database using http service to fetch json contract.', 'unstructured data was handled using mongo db and used mongoose connector for connecting to database.', 'composed and executed mongodb scripts and queries to fetch and test data from nosql databases.', 'responsible for installation configuration of jenkins to support various java builds and jenkins plugins to automate continuous builds and publishing docker images to the nexus repository.', 'used ci cd tools jenkins git gitlaband docker registry for configuration and automation using ansible.', 'used drools as rule engine to categorize salient level rule to every business rules base on the business needs.', 'experienced in working with babel and webpack in application build and deployment processes.', 'created plugins to extract data from multiple sources like apache kafka database and messaging queues.', 'ran log aggregations website activity tracking and commit log for distributed system using apache kafka.', 'deployed and monitored scalable infrastructure on amazon web services specifically on aws ec 2.', 'performed ui and front end testing using selenium. developed test case and performed unit testing with mocha', 'environment html 5 css 3 react js babel spring boot spring aop spring ioc hibernate nodejs webpack json jenkins git docker nexus mongoose mongodb chai webpack mocha selenium apachekafka aws.', 'client carefirst baltimore md jan 14 to july 15 role java developer', 'work highlights', 'focused on test driven development thereby creating detailed junit tests for every single piece of functionality.', 'developed and designed user interface using javascript html css dom xhtml ajax bootstrap angular js.', 'developed the j 2 ee application based on the service oriented architecture.', 'developed user interface with technologies like html angular js and jquery.', 'used angular two way binding and implemented the search functionality using angular js.', 'used angular js directives like ng app ng model ng repeat ng show ng hide ng controller ng route.', 'involved in configuring mapping files and pojo objects and used singleton design pattern for web application.', 'implemented logging using log 4 j and implemented various cross project functionalities using spring aop.', 'developed web applications using spring mvc to maintain loose coupling between the layers.', 'used spring orm module to integrate with hibernate.', 'used apache maven for project management and building the application.', 'used log 4 j utility to generate run time logs and cvs was used for project management and version management.', 'performed regression testing on new builds every modification in the application using selenium web driver.', 'deployed the application onto weblogic application server and developed functional requirement document for beans binding and seamless integration with spring framework and for routing unit test by apache camel.', 'used pivotal cloud foundry to quickly build deploy and update the applications', 'used ant and jenkins for build process and continuous integration.', 'utilized grunt and node for templating and build component based angular architecture and sass preprocessing', 'implemented core javamultithreading collections exception handling and used generics.', 'developed test driven development code using junit java.', 'involved in requirements gathering and capacity planning for multi datacenter and cassandra cluster.', 'used karma test runner and jasmine testing frameworks.', 'environment cassandra j 2 ee java 1.6 spring framework spring mvc spring aop spring orm hibernate jsp 2.0 angular js web services xml aws pivotal cloud foundry jquery log 4 j javascript oracle 10 g weblogic apache maven html 5 karma jasmine junit jenkins.', 'client mind tree bangalore india may 12 to jun 2013', 'role java app developer', 'work highlights', 'designed and coded application components in an agile environment.', 'implemented model view controller mvc 2 architecture using jakarta struts framework at presentation tier.', 'used struts frameworks and mvc design patterns to complete several projects on complex areas of development including user interface design batch processing stored procedure development xml data exchange and integration.', 'extensive use of struts framework for controller components and view components.', 'implemented spring ioc for inter connection between modules in our application.', 'designed and developed ui using jsp by following mvc architecture.', 'developed the application using struts framework. the views are programmed using jsp pages with the struts tag library model is the combination of ejb s and java classes and web implementation controllers are servlets.', 'the java message service jms api used to allow application components to create send receive and read messages.', 'expertise in coding optimized sql queries on databases like oracle.', 'developed back end pl sql packages unix shell scripts for data migration and batch processing.', 'created and customized unix shell scripts for automating regular maintenance and batch jobs.', 'implemented core java multithreading collections exception handling and oop s concepts.', 'involved in coding building java applications using core java multithreading jsp and servlet.', 'involved in performing unit and integration testing junit.', 'environment core java j 2 ee 1.3 jsp 1.2 structs spring ioc ejb 2.0 struts 1.1 jdbc 2.1 oracle 8 i uml jms xml web logic 7.0 mvc design pattern eclipse 2.1 log 4 j and junit.']
    print( "+++++",obj.match(text))



